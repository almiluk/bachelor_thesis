\chapter{Онтологически управляемые периферийные вычисления. Постановка задач}

\section{Общие идеи подхода}

Онтологически управляемые периферийные вычисления (англ. Ontology-Driven Edge Computing)- подход, основанный на внедрении интеллектуальности в периферийные устройства в рамках экосистемы интернета вещей (IoT). 
В этом подходе использование онтологий позволяет описывать и управлять функциональностью и поведением периферийных устройств на основе знаний и семантических моделей.

В рамках такого подхода традиционная прошивка (встраиваемая программа) устройств заменяется на комбинацию трёх компонентов:
\begin{enumerate}
	\item Доменной онтологии, описывающей доступные для выполнения на устройстве действия, средства коммуникации устройства, его состав и другие знания, жёстко привязанные к устройству.
	\item Онтологии задачи, описывающая действия необходимые для решения конкретной задачи.
	\item Механизма рассуждений, выполняющий вычисления, описываемы онтологией задачи.
	Своего рода интерпретатор алгоритмов, записанных в онтологическом виде.
\end{enumerate}

Механизм рассуждений является классической прошивкой периферийных устройств и выполняется непосредственно на нём.
Доменная онтология используется для составления онтологии задач, а также её сжатия и разжатия с использованием формата EON, описанного ниже.
За счёт этого, отсутствует необходимость хранить такую онтологию на конечном устройстве, так как она не используется непосредственно в момент вычислений, в отличие от онтологии задачи.
Доменная онтология может храниться на отдельном внешнем устройстве, к которому у устройства, производящего вычисления есть сетевой доступ.

\section{Онтологически управляемые периферийные вычисления в системе SciVi}

На основе доменной онтологии средства SciVi генерируют инструменты для получения, обработки и визуализации различных данных.
Для использования этих инструментов SciVi предоставляет высокоуровневый графический интерфейс пользователя, также генерируемый на основе доменной онтологии.
Данный интерфейс позволяет создавать диаграммы потоков данных (англ. Data Flow Diagrams, DFD), описывая узлы обработки данных и то, как между ними должны передаваться данные.
В рамках SciVi такие узлы именуются операторами.
Операторы описывают различные операции с данными, которые могут выполнены на клиентской или серверной частях платформы, а также на внешнем периферийном устройстве.
Для реализации последнего вариант и применяется подход онтологически управляемых периферийных вычислений.

На основе DFD, созданной пользователем, SciVi генерирует онтологию задачи, соответствующую операциям с данными для выполнения на периферийном устройстве.
Затем эта онтология сжимается и передаётся на конечное устройство, где она исполняется с помощью механизма рассуждений, после чего результаты её выполнения могут быть переданы другим устройствам в соответствии с составленной DFD.

В качестве периферийных устройств SciVi, в основном, использует микроконтроллеры ESP8266, которые будут являться целевой платформой для последующих разработок в рамках данной работы.

\section{Когнитивное сжатие онтологий. Формат EON}

Микроконтроллеры обычно обладают небольшим объёмом оперативной памяти, например, у популярного микроконтроллера ATtiny45 её объём составляет всего 256 байт.
В следствии этого хранить на устройстве онтологии задач в обычных форматах для описания онтологий, таких как: OWL и RFD, не представляется возможным.
Для сжатия онтологий в процессе работы над платформой SciVi был разработан специальный формат~--- EON (англ. Embedded or Edge ONtology).

Перевод онтологии в формат EON включается в себя два основных этапа:
\begin{enumerate}
	\item Когнитивное сжатие. 
	На данном этапе из онтологии удаляются избыточные знания, которые в будущем могут быть восстановлены с помощью доменной библиотеки.
	Затем из онтологии удаляются все связи, кроме instance_of (с их помощью онтология задачи связывается с доменной, поэтому они необходимы для разжатия) и use_for (эта связь используется для описания направления передачи данных на основе DFD).
	Важно отметить, что набор сохраняемых связей не является фиксированным и может быть изменён (в том числе расширен) при необходимости.
	Кроме того все имена узлов и связей заменяются на численные идентификаторы.
	Для связей и узлов доменной онтологии идентификаторы берутся из неё самой, а для узлов онтологии задач генерируются автоматически и сохраняются во время всего процесса обработки онтологии.
	\item Затем полученная онтология сериализуется в особый бинарный формат EON, в котором в дальнейшем передаётся и обрабатывается.
\end{enumerate}

При необходимости всегда может быть проведён обратный процесс разжатия, требующий только доменной онтологии, аналогичной той, что использовалась при сжатии.

\section{Встраиваемый механизм рассуждений}

Механизм рассуждений работает на самих периферийных устройствах и с их точки зрения является является обычной прошивкой.
Архитектура такого механизма представлена на рисунке /ref{fig:reasoner} (источник изображения~--- статья разработчиков данного механизма\cite{article:ODEC}).

\myfigure[width=\columnwidth]{reasoner}{Архитектура встраиваемого механизма рассуждений}{fig:reasoner}

\begin{itemize}
	\item Модуль функций (Functions Module на рисунке). Модуль управляет аппаратными ресурсами устройства и определяет доступные для использования операторы SciVi.
	\item Модуль коммуникации (Communication Module). Модуль обеспечивает передачу данных и команд между этим и другими устройствами системы SciVi.
	В зависимости от устройства, модуль может включать средства для сетевой связи по протоколу WebSocket, через интерфейс UART и различными иными способами.
	\item Модуль выполнения (Evaluation Core). Элемент обходит онтологию задачи в формате EON и вызывает операторы.
	\item Модуль чтения/записи (EON Reader/Writer). Элемент осуществляет чтение и запись онтологии в память устройства.
	\item Буфер результатов (Evaluation Buffer). Буфер для хранения результатов выполнения операторов.
	\item Буфер замещения (Substitution Buffer). Буфер для перезаписи результатов выполнения операторов и управления устройством извне через модуль коммуникации.
\end{itemize}

Данный механизм реализован в рамках платформы SciVi на языке программирования C++ и может исполнятся на различных устройствах (протестирован на ESP8266, ATmega328 и ATtiny45).
Эта реализация может быль перенесена и на множество других устройств, за счёт использования универсальных инструментов среды разработки Arduino IDE и различных дополнений к ней.

Важно отметить, что различные устройства могут отличаться набором доступных операций и средств связи, поэтому итоговые прошивки, использующие описанный механизм, для разных устройств должны отличаться.
Для решения этой проблемы SciVi имеет специальное средство, генерирующие конкретные прошивки, содержащие встраиваемый механизм рассуждений, автоматически на основе онтологического описания целевого устройства, создаваемого пользователем.

\section{Существующих проблемы коммуникации механизма рассуждений}

На момент начала данной работы описанный механизм имел две значительные проблемы проблемы, связанные с коммуникацией с его окружением.

\subsection{Использование энергонезависимой памяти}

Энергонезависимая память~--- особый вид запоминающих устройств, способный хранить данные при отсутствии электропитания.
Такая память используется в составе вычислительных устройств, в том числе для хранения данных, необходимых для их инициализации, и конфигурационных данных между их запусками.
В микроконтроллерах для решения этой задачи обычно используются электрически стираемые перепрограммируемые постоянные запоминающие устройства (ЭСППЗУ, англ. Electrically Erasable Programmable Read-Only Memory, EEPROM)~--- вид устройств энергонезависимой памяти, позволяющих электрическим импульсом стереть сохранённые данные, а затем, при необходимости, записать новые \cite{incollection:eeprom-proposal, article:eeprom}.

Механизм рассуждений SciVi использует EEPROM для хранения онтологий задач.
Это необходимо для того, чтобы устройство могло автоматически возобновить исполнение полученного им ранее алгоритма после временного отсутствия электропитания.
Такое хранение уже было реализована в SciVi, однако для работы с EEPROM использовались несовершенные и низкоуровневые средства, которые не позволяют удобно использовать EEPROM из независимых программных модулей, в следствии необходимости ручных манипуляций с адресами памяти при каждом обращении к ней.
То есть, использование энергонезависимой памяти микроконтроллера механизмом рассуждений делало невозможным её использование для других целей, несмотря на достаточный её объём.

Таким образом платформа SciVi было необходимо новое, более высокоуровневое средство для управления EEPROM, которое бы могло автоматизировать использование адресов памяти.

\subsection{}

Другой проблема связана с сетевой коммуникацией устройства, а именно~--- с его обнаружением в сети.
Изначально клиентская часть SciVi могла подключаться только к одному периферийному устройству, причём по строго фиксированному IP-адресу.
Этот факт очень сильно ограничивал возможности использования платформы, и ей потребовался механизм, позволяющий в любой сети легко находить устройства для выполнения на них онтологически управляемых периферийных вычислений.
После нахождения всех таких доступных устройств, пользователь смогу бы выбирать на каком из них выполнять тот или иной оператор SciVi.

